<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Keza & Naomie | Coach Sportif Certifi√©</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Rajdhani:wght@300;400;500;600;700&family=Space+Mono:ital@0;1&display=swap" rel="stylesheet">
    <style>
        :root {
            --black: #080808;
            --dark: #0f0f0f;
            --dark-mid: #1a1a1a;
            --card: #141414;
            --gold: #c9a84c;
            --gold-light: #e8c96d;
            --gold-dark: #8a6f2e;
            --red: #c0392b;
            --red-light: #e74c3c;
            --white: #f0ede8;
            --grey: #888;
            --grey-light: #aaa;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Rajdhani', sans-serif; background: var(--black); color: var(--white); min-height: 100vh; overflow-x: hidden; }
        .bg-layer { position: fixed; inset: 0; z-index: 0; }
        .bg-image { position: absolute; inset: 0; background: linear-gradient(to bottom, rgba(8,8,8,0.92) 0%, rgba(8,8,8,0.75) 40%, rgba(8,8,8,0.95) 100%), url('https://images.unsplash.com/photo-1534438327276-14e5300c3a48?w=1600&q=80') center/cover no-repeat; }
        .bg-grain { position: absolute; inset: 0; background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.04'/%3E%3C/svg%3E"); opacity: 0.4; }
        .bg-lines { position: absolute; inset: 0; background-image: repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(201,168,76,0.02) 2px, rgba(201,168,76,0.02) 4px); }
        .bg-vignette { position: absolute; inset: 0; background: radial-gradient(ellipse at center, transparent 40%, rgba(0,0,0,0.8) 100%); }

        /* PAGES */
        .page { position: relative; z-index: 1; min-height: 100vh; display: none; }
        .page.active { display: block; }
        #onboarding.active { display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 40px 20px; }

        /* HEADER */
        .header-line { width: 60px; height: 2px; background: var(--gold); margin: 0 auto 20px; }
        .brand { font-family: 'Bebas Neue', sans-serif; font-size: clamp(3rem, 8vw, 5rem); letter-spacing: 0.1em; line-height: 1; color: var(--white); text-shadow: 0 0 60px rgba(201,168,76,0.3); }
        .brand span { color: var(--gold); }
        .tagline { font-family: 'Space Mono', monospace; font-size: 0.7rem; letter-spacing: 0.3em; color: var(--gold); text-transform: uppercase; margin-top: 12px; }
        .certified { display: inline-flex; align-items: center; gap: 8px; margin-top: 14px; padding: 6px 18px; border: 1px solid rgba(201,168,76,0.3); font-size: 0.72rem; letter-spacing: 0.2em; color: var(--gold); text-transform: uppercase; }

        /* PR√âNOM INPUT */
        .prenom-input-wrap { position: relative; margin-top: 5px; }
        .prenom-input { width: 100%; padding: 16px 20px; background: var(--card); border: 1px solid rgba(255,255,255,0.1); color: var(--white); font-family: 'Rajdhani', sans-serif; font-size: 1.2rem; font-weight: 600; letter-spacing: 0.1em; outline: none; transition: border-color 0.3s; }
        .prenom-input::placeholder { color: var(--grey); font-weight: 400; }
        .prenom-input:focus { border-color: var(--gold); }

        /* SALUTATION */
        .salutation-wrap { margin-bottom: 8px; }
        .salutation-text { font-family: 'Space Mono', monospace; font-size: 0.75rem; letter-spacing: 0.25em; color: var(--grey); text-transform: uppercase; }
        .user-greeting { font-family: 'Bebas Neue', sans-serif; font-size: clamp(2rem, 5vw, 3.5rem); letter-spacing: 0.08em; color: var(--white); line-height: 1.1; margin-top: 4px; }
        .user-greeting span { color: var(--gold); }
        .onboard-header { text-align: center; margin-bottom: 50px; animation: fadeInDown 0.8s ease; }
        .onboard-form { width: 100%; max-width: 700px; animation: fadeInUp 0.8s ease 0.2s both; }
        .step { margin-bottom: 35px; }
        .step-label { font-family: 'Space Mono', monospace; font-size: 0.65rem; letter-spacing: 0.3em; color: var(--gold); text-transform: uppercase; margin-bottom: 15px; display: flex; align-items: center; gap: 12px; }
        .step-label::after { content: ''; flex: 1; height: 1px; background: rgba(201,168,76,0.2); }
        .step-num { font-family: 'Bebas Neue', sans-serif; font-size: 0.9rem; color: rgba(201,168,76,0.5); }
        .options-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 12px; }
        .option-btn { padding: 18px 15px; background: var(--card); border: 1px solid rgba(255,255,255,0.08); color: var(--grey-light); font-family: 'Rajdhani', sans-serif; font-size: 1rem; font-weight: 600; letter-spacing: 0.1em; text-transform: uppercase; cursor: pointer; transition: all 0.3s; text-align: center; position: relative; overflow: hidden; }
        .option-btn .opt-emoji { display: block; font-size: 1.8rem; margin-bottom: 8px; }
        .option-btn .opt-sub { display: block; font-size: 0.72rem; color: var(--grey); letter-spacing: 0.15em; margin-top: 4px; font-weight: 400; }
        .option-btn:hover { border-color: var(--gold); color: var(--white); transform: translateY(-2px); }
        .option-btn.selected { background: rgba(201,168,76,0.1); border-color: var(--gold); color: var(--gold); }
        .option-btn.selected::before { content: '‚úì'; position: absolute; top: 8px; right: 10px; font-size: 0.8rem; color: var(--gold); }
        .launch-btn { width: 100%; padding: 20px; background: var(--red); border: none; color: var(--white); font-family: 'Bebas Neue', sans-serif; font-size: 1.6rem; letter-spacing: 0.25em; cursor: pointer; transition: all 0.3s; margin-top: 10px; opacity: 0.4; pointer-events: none; }
        .launch-btn.ready { opacity: 1; pointer-events: all; }
        .launch-btn.ready:hover { background: var(--red-light); transform: translateY(-2px); box-shadow: 0 10px 30px rgba(192,57,43,0.4); }

        /* MAIN APP */
        .wrapper { max-width: 1100px; margin: 0 auto; padding: 0 20px 60px; }
        header { padding: 50px 0 40px; text-align: center; }
        .profile-badge { display: inline-flex; align-items: center; gap: 12px; padding: 8px 20px; border: 1px solid rgba(201,168,76,0.3); margin-top: 16px; cursor: pointer; transition: all 0.3s; }
        .profile-badge:hover { border-color: var(--gold); background: rgba(201,168,76,0.05); }
        .profile-badge span { font-family: 'Space Mono', monospace; font-size: 0.65rem; letter-spacing: 0.2em; color: var(--gold); text-transform: uppercase; }

        /* DAY BANNER */
        .day-banner { background: linear-gradient(135deg, var(--gold-dark), var(--gold)); padding: 20px 30px; margin-bottom: 30px; display: flex; align-items: center; justify-content: space-between; clip-path: polygon(0 0, calc(100% - 20px) 0, 100% 50%, calc(100% - 20px) 100%, 0 100%, 20px 50%); animation: fadeIn 0.8s ease; }
        .day-banner .day-name { font-family: 'Bebas Neue', sans-serif; font-size: 2.5rem; color: var(--black); letter-spacing: 0.1em; line-height: 1; }
        .day-banner .day-focus { font-size: 0.9rem; font-weight: 700; color: rgba(0,0,0,0.7); letter-spacing: 0.2em; text-transform: uppercase; }
        .day-badge { background: rgba(0,0,0,0.2); padding: 8px 16px; font-family: 'Space Mono', monospace; font-size: 0.7rem; color: var(--black); letter-spacing: 0.1em; }

        /* GRID & CARDS */
        .main-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
        @media (max-width: 768px) { .main-grid { grid-template-columns: 1fr; } }
        .card { background: var(--card); border: 1px solid rgba(255,255,255,0.06); padding: 28px; position: relative; overflow: hidden; animation: fadeInUp 0.6s ease both; }
        .card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px; background: linear-gradient(90deg, transparent, var(--gold), transparent); }
        .card-full { grid-column: 1 / -1; }
        .card-label { font-family: 'Space Mono', monospace; font-size: 0.65rem; letter-spacing: 0.3em; color: var(--gold); text-transform: uppercase; margin-bottom: 20px; display: flex; align-items: center; gap: 10px; }
        .card-label::after { content: ''; flex: 1; height: 1px; background: rgba(201,168,76,0.2); }

        /* WORKOUT */
        .workout-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; }
        .exercise-card { background: var(--dark-mid); border: 1px solid rgba(255,255,255,0.06); padding: 20px; position: relative; transition: all 0.3s; }
        .exercise-card:hover { border-color: var(--gold); transform: translateY(-3px); background: rgba(201,168,76,0.05); }
        .exercise-card .ex-name { font-family: 'Bebas Neue', sans-serif; font-size: 1.4rem; letter-spacing: 0.05em; color: var(--white); margin-bottom: 6px; }
        .exercise-card .ex-sets { font-size: 0.85rem; color: var(--gold); font-weight: 600; margin-bottom: 8px; }
        .exercise-card .ex-focus { font-size: 0.8rem; color: var(--grey); line-height: 1.5; }
        .exercise-card .ex-number { position: absolute; top: 12px; right: 15px; font-family: 'Bebas Neue', sans-serif; font-size: 2rem; color: rgba(201,168,76,0.15); line-height: 1; }

        /* DIFFICULTY */
        .diff-row { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
        .diff-btn { padding: 8px 20px; background: transparent; border: 1px solid rgba(255,255,255,0.1); color: var(--grey); font-family: 'Rajdhani', sans-serif; font-size: 0.85rem; font-weight: 600; letter-spacing: 0.15em; text-transform: uppercase; cursor: pointer; transition: all 0.3s; }
        .diff-btn:hover { border-color: var(--gold); color: var(--gold); }
        .diff-btn.active { background: var(--gold); border-color: var(--gold); color: var(--black); }

        /* GENERATE BTN */
        .generate-btn { width: 100%; padding: 18px; background: var(--red); border: none; color: var(--white); font-family: 'Bebas Neue', sans-serif; font-size: 1.5rem; letter-spacing: 0.2em; cursor: pointer; transition: all 0.3s; }
        .generate-btn:hover { background: var(--red-light); transform: translateY(-2px); }

        /* CHALLENGE DISPLAY */
        .challenge-result { display: none; margin-top: 20px; border: 1px solid rgba(201,168,76,0.3); background: rgba(201,168,76,0.03); padding: 25px; animation: slideIn 0.4s ease; }
        .challenge-result.visible { display: block; }
        .ch-name { font-family: 'Bebas Neue', sans-serif; font-size: 2.2rem; letter-spacing: 0.05em; color: var(--gold); margin-bottom: 8px; }
        .ch-desc { font-size: 1rem; color: var(--grey-light); line-height: 1.6; margin-bottom: 15px; }
        .ch-info-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 15px; }
        .ch-info-item { background: var(--dark-mid); padding: 12px; text-align: center; }
        .ch-info-item .info-val { font-family: 'Bebas Neue', sans-serif; font-size: 1.3rem; color: var(--gold); display: block; }
        .ch-info-item .info-key { font-size: 0.7rem; color: var(--grey); letter-spacing: 0.1em; text-transform: uppercase; }
        .ch-focus-box { background: var(--dark-mid); border-left: 3px solid var(--gold); padding: 15px; margin-bottom: 15px; }
        .ch-focus-box .focus-title { font-size: 0.7rem; letter-spacing: 0.2em; color: var(--gold); text-transform: uppercase; margin-bottom: 6px; }
        .ch-focus-box .focus-text { font-size: 0.9rem; color: var(--grey-light); line-height: 1.6; }
        .complete-btn { width: 100%; padding: 14px; background: transparent; border: 1px solid var(--gold); color: var(--gold); font-family: 'Bebas Neue', sans-serif; font-size: 1.2rem; letter-spacing: 0.2em; cursor: pointer; transition: all 0.3s; }
        .complete-btn:hover { background: var(--gold); color: var(--black); }

        /* STATS */
        .stats-row { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; }
        .stat-box { background: var(--dark-mid); padding: 20px; text-align: center; border: 1px solid rgba(255,255,255,0.04); transition: border-color 0.3s; }
        .stat-box:hover { border-color: rgba(201,168,76,0.3); }
        .stat-num { font-family: 'Bebas Neue', sans-serif; font-size: 3rem; color: var(--gold); line-height: 1; display: block; }
        .stat-lbl { font-size: 0.75rem; color: var(--grey); letter-spacing: 0.15em; text-transform: uppercase; margin-top: 6px; }

        /* RECETTES & COLLATIONS */
        .food-section { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        @media (max-width: 768px) { .food-section { grid-template-columns: 1fr; } }

        .food-sub-label { font-family: 'Space Mono', monospace; font-size: 0.6rem; letter-spacing: 0.25em; color: var(--gold); text-transform: uppercase; margin-bottom: 14px; padding-bottom: 8px; border-bottom: 1px solid rgba(201,168,76,0.15); }

        .recette-card { background: var(--dark-mid); border: 1px solid rgba(255,255,255,0.05); padding: 18px; margin-bottom: 12px; transition: all 0.3s; cursor: pointer; }
        .recette-card:hover { border-color: var(--gold); background: rgba(201,168,76,0.04); }
        .recette-card:last-child { margin-bottom: 0; }
        .recette-header { display: flex; align-items: center; gap: 12px; margin-bottom: 8px; }
        .recette-emoji { font-size: 1.6rem; }
        .recette-info { flex: 1; }
        .recette-name { font-family: 'Bebas Neue', sans-serif; font-size: 1.15rem; letter-spacing: 0.05em; color: var(--white); }
        .recette-meta { display: flex; gap: 10px; margin-top: 2px; }
        .recette-tag { font-family: 'Space Mono', monospace; font-size: 0.6rem; color: var(--gold); letter-spacing: 0.1em; }
        .recette-desc { font-size: 0.82rem; color: var(--grey); line-height: 1.5; margin-bottom: 10px; }
        .recette-ingredients { display: flex; flex-wrap: wrap; gap: 6px; }
        .ingredient-pill { padding: 3px 10px; background: rgba(201,168,76,0.08); border: 1px solid rgba(201,168,76,0.2); font-size: 0.72rem; color: var(--grey-light); letter-spacing: 0.05em; }

        .collation-item { display: flex; align-items: flex-start; gap: 12px; padding: 14px; background: var(--dark-mid); border-left: 2px solid var(--gold); margin-bottom: 10px; transition: all 0.3s; }
        .collation-item:last-child { margin-bottom: 0; }
        .collation-item:hover { background: rgba(201,168,76,0.04); }
        .collation-emoji { font-size: 1.4rem; flex-shrink: 0; }
        .collation-text { flex: 1; }
        .collation-title { font-weight: 700; font-size: 0.9rem; color: var(--white); margin-bottom: 3px; }
        .collation-desc { font-size: 0.78rem; color: var(--grey); line-height: 1.5; }
        .collation-kcal { font-family: 'Space Mono', monospace; font-size: 0.6rem; color: var(--gold); margin-top: 4px; letter-spacing: 0.1em; }

        /* WEEK */
        .week-row { display: grid; grid-template-columns: repeat(7, 1fr); gap: 8px; }
        @media (max-width: 768px) { .week-row { grid-template-columns: repeat(4, 1fr); } }
        .week-day { padding: 12px 8px; text-align: center; background: var(--dark-mid); border: 1px solid rgba(255,255,255,0.04); cursor: pointer; transition: all 0.3s; }
        .week-day:hover { border-color: var(--gold); }
        .week-day.today { border-color: var(--gold); background: rgba(201,168,76,0.1); }
        .week-day .wd-day { font-family: 'Space Mono', monospace; font-size: 0.6rem; letter-spacing: 0.1em; color: var(--grey); text-transform: uppercase; margin-bottom: 6px; }
        .week-day .wd-focus { font-size: 0.75rem; font-weight: 700; color: var(--white); }
        .week-day.today .wd-day, .week-day.today .wd-focus { color: var(--gold); }

        /* HISTORY */
        .history-list { display: flex; flex-direction: column; gap: 8px; max-height: 250px; overflow-y: auto; }
        .history-list::-webkit-scrollbar { width: 3px; }
        .history-list::-webkit-scrollbar-thumb { background: var(--gold-dark); }
        .history-item { display: flex; justify-content: space-between; align-items: center; padding: 12px 15px; background: var(--dark-mid); border-left: 2px solid transparent; transition: border-color 0.3s; }
        .history-item:hover { border-left-color: var(--gold); }
        .history-item .h-name { font-weight: 600; font-size: 0.9rem; }
        .history-item .h-date { font-family: 'Space Mono', monospace; font-size: 0.7rem; color: var(--grey); }
        .empty-msg { text-align: center; color: var(--grey); font-style: italic; padding: 30px; font-size: 0.9rem; }

        /* FOOTER */
        footer { text-align: center; padding: 40px 0 20px; border-top: 1px solid rgba(255,255,255,0.06); margin-top: 40px; }
        .footer-brand { font-family: 'Bebas Neue', sans-serif; font-size: 1.5rem; letter-spacing: 0.2em; color: var(--gold); margin-bottom: 4px; }
        .footer-sub { font-family: 'Space Mono', monospace; font-size: 0.65rem; letter-spacing: 0.3em; color: var(--grey); text-transform: uppercase; }

        /* TOAST */
        .toast { position: fixed; bottom: 30px; right: 30px; background: var(--gold); color: var(--black); padding: 15px 25px; font-weight: 700; font-size: 0.9rem; letter-spacing: 0.1em; z-index: 1000; transform: translateY(100px); opacity: 0; transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1); }
        .toast.show { transform: translateY(0); opacity: 1; }

        /* ANIMATIONS */
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes fadeInDown { from { opacity: 0; transform: translateY(-30px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slideIn { from { opacity: 0; transform: scaleY(0.95); transform-origin: top; } to { opacity: 1; transform: scaleY(1); } }
    </style>
</head>
<body>

<div class="bg-layer">
    <div class="bg-image"></div>
    <div class="bg-grain"></div>
    <div class="bg-lines"></div>
    <div class="bg-vignette"></div>
</div>

<!-- PAGE 1: ONBOARDING -->
<div class="page active" id="onboarding">
    <div class="onboard-header">
        <div class="header-line"></div>
        <div class="tagline">Programme Fitness Personnalis√©</div>
        <div class="certified">‚ú¶ Coach Sportif Certifi√© ‚ú¶</div>
    </div>

    <div class="onboard-form">
        <div class="step">
            <div class="step-label"><span class="step-num">01</span> Mon pr√©nom</div>
            <div class="prenom-input-wrap">
                <input class="prenom-input" type="text" id="prenomInput" placeholder="Entre ton pr√©nom ici..." maxlength="30" oninput="checkReady()">
            </div>
        </div>

        <div class="step">
            <div class="step-label"><span class="step-num">02</span> Tu es</div>
            <div class="options-grid">
                <button class="option-btn" data-group="gender" data-value="femme">
                    <span class="opt-emoji">üë©</span>Femme<span class="opt-sub">Programme f√©minin</span>
                </button>
                <button class="option-btn" data-group="gender" data-value="homme">
                    <span class="opt-emoji">üë®</span>Homme<span class="opt-sub">Programme masculin</span>
                </button>
                <button class="option-btn" data-group="gender" data-value="neutre">
                    <span class="opt-emoji">‚ö°</span>Neutre<span class="opt-sub">Programme √©quilibr√©</span>
                </button>
            </div>
        </div>

        <div class="step">
            <div class="step-label"><span class="step-num">03</span> Mon objectif principal</div>
            <div class="options-grid">
                <button class="option-btn" data-group="goal" data-value="perte">
                    <span class="opt-emoji">üî•</span>Perdre du poids<span class="opt-sub">Cardio & d√©ficit</span>
                </button>
                <button class="option-btn" data-group="goal" data-value="muscle">
                    <span class="opt-emoji">üí™</span>Prendre du muscle<span class="opt-sub">Force & volume</span>
                </button>
                <button class="option-btn" data-group="goal" data-value="tonifier">
                    <span class="opt-emoji">‚ú®</span>Tonifier<span class="opt-sub">Galbe & fermet√©</span>
                </button>
                <button class="option-btn" data-group="goal" data-value="endurance">
                    <span class="opt-emoji">üèÉ</span>Endurance<span class="opt-sub">Cardio & r√©sistance</span>
                </button>
            </div>
        </div>

        <div class="step">
            <div class="step-label"><span class="step-num">04</span> Mon niveau</div>
            <div class="options-grid">
                <button class="option-btn" data-group="level" data-value="debutant">
                    <span class="opt-emoji">üå±</span>D√©butant<span class="opt-sub">Je commence</span>
                </button>
                <button class="option-btn" data-group="level" data-value="intermediaire">
                    <span class="opt-emoji">‚ö°</span>Interm√©diaire<span class="opt-sub">6 mois+ d'entra√Ænement</span>
                </button>
                <button class="option-btn" data-group="level" data-value="avance">
                    <span class="opt-emoji">üèÜ</span>Avanc√©<span class="opt-sub">2 ans+ d'entra√Ænement</span>
                </button>
            </div>
        </div>

        <button class="launch-btn" id="launchBtn" onclick="launchApp()">
            ‚ö° Lancer Mon Programme Personnalis√©
        </button>
    </div>
</div>

<!-- PAGE 2: MAIN APP -->
<div class="page" id="mainApp">
    <div class="wrapper">
        <header>
            <div class="header-line"></div>
            <div class="salutation-wrap">
                <div class="salutation-text" id="salutationText">Bienvenue</div>
                <div class="user-greeting" id="userGreeting">Chargement...</div>
            </div>
            <div class="profile-badge" onclick="resetProfile()" title="Changer de profil">
                <span id="profileSummary">Mon profil</span>
                <span>‚úé Modifier</span>
            </div>
        </header>

        <div class="day-banner">
            <div>
                <div class="day-name" id="dayName">LUNDI</div>
                <div class="day-focus" id="dayFocus">ü¶µ JAMBES</div>
            </div>
            <div class="day-badge" id="dayDate"></div>
        </div>

        <div class="card card-full" style="margin-bottom:20px">
            <div class="card-label">Programme de la semaine</div>
            <div class="week-row" id="weekRow"></div>
        </div>

        <div class="main-grid">
            <div class="card card-full">
                <div class="card-label" id="workoutLabel">S√©ance du jour</div>
                <div class="workout-grid" id="workoutGrid"></div>
            </div>

            <div class="card">
                <div class="card-label">D√©fi al√©atoire du jour</div>
                <div class="diff-row">
                    <button class="diff-btn active" data-diff="all">Tous</button>
                    <button class="diff-btn" data-diff="facile">Facile</button>
                    <button class="diff-btn" data-diff="moyen">Moyen</button>
                    <button class="diff-btn" data-diff="difficile">Difficile</button>
                </div>
                <button class="generate-btn" id="generateBtn">‚ö° G√©n√©rer Mon D√©fi</button>
                <div class="challenge-result" id="challengeResult">
                    <div class="ch-name" id="chName"></div>
                    <div class="ch-desc" id="chDesc"></div>
                    <div class="ch-info-grid">
                        <div class="ch-info-item"><span class="info-val" id="chCat"></span><span class="info-key">Cat√©gorie</span></div>
                        <div class="ch-info-item"><span class="info-val" id="chDiff"></span><span class="info-key">Difficult√©</span></div>
                        <div class="ch-info-item"><span class="info-val" id="chPts"></span><span class="info-key">Points</span></div>
                    </div>
                    <div class="ch-focus-box">
                        <div class="focus-title">üéØ Focus musculaire</div>
                        <div class="focus-text" id="chFocus"></div>
                    </div>
                    <button class="complete-btn" id="completeBtn">‚úì D√©fi Compl√©t√©</button>
                </div>
            </div>

            <div class="card">
                <div class="card-label">Tes performances</div>
                <div class="stats-row">
                    <div class="stat-box"><span class="stat-num" id="statTotal">0</span><div class="stat-lbl">D√©fis compl√©t√©s</div></div>
                    <div class="stat-box"><span class="stat-num" id="statStreak">0</span><div class="stat-lbl">S√©rie actuelle</div></div>
                    <div class="stat-box"><span class="stat-num" id="statBest">0</span><div class="stat-lbl">Meilleure s√©rie</div></div>
                </div>
            </div>

            <div class="card card-full">
                <div class="card-label" id="foodLabel">Recettes & Collations du jour</div>
                <div class="food-section">
                    <div>
                        <div class="food-sub-label">üçΩÔ∏è Recettes recommand√©es</div>
                        <div id="recettesGrid"></div>
                    </div>
                    <div>
                        <div class="food-sub-label">ü•§ Collations healthy</div>
                        <div id="collationsGrid"></div>
                    </div>
                </div>
            </div>

            <div class="card card-full">
                <div class="card-label">Historique r√©cent</div>
                <div class="history-list" id="historyList">
                    <div class="empty-msg">Aucun d√©fi compl√©t√© pour le moment. Lance-toi ! üí™</div>
                </div>
            </div>
        </div>

        <footer>
            <div class="footer-brand">KEZA & NAOMIE</div>
            <div class="footer-sub">Coach Sportif Certifi√© ¬∑ Fitness Challenge Program ¬© 2026</div>
        </footer>
    </div>
</div>

<div class="toast" id="toast"></div>

<script>
const PROGRAMS = {
    femme: {
        1:{name:'LUNDI',focus:'FESSIERS & CUISSES',emoji:'üçë',exercises:[{name:'Hip Thrust',sets:'4x20 reps',focus:'Isolation maximale des fessiers. Exercice le plus efficace pour tonifier et galber les glutes.'},{name:'Squats Sumo',sets:'4x15 reps',focus:'Adducteurs, fessiers et quadriceps. La position sumo cible davantage les fessiers internes.'},{name:'Fentes Lat√©rales',sets:'3x12/c√¥t√©',focus:'Abducteurs, adducteurs et fessiers. Affine les faces internes et externes des cuisses.'},{name:'Donkey Kicks',sets:'4x20/c√¥t√©',focus:'Isolation parfaite du grand fessier. Id√©al pour le galbe et la remont√©e des fessiers.'},{name:'Pont Fessier',sets:'4x25 reps',focus:'Grand et moyen fessiers. Accessible √† tous les niveaux, tr√®s efficace pour tonifier.'},{name:'Leg Curl',sets:'3x15 reps',focus:'Ischio-jambiers et sous-fessiers. Affine arri√®re des cuisses et remonte les fessiers.'}],
        recettes:[{emoji:'üçó',name:'Bowl Prot√©in√© Fessiers',desc:'Riz complet + poulet grill√© aux herbes + l√©gumes r√¥tis + sauce tahini l√©g√®re. Id√©al apr√®s la s√©ance pour reconstruire les muscles.',kcal:'480 kcal',temps:'25 min',ingredients:['Poulet 150g','Riz complet','Courgette','Poivron','Tahini','Herbes de Provence']},{emoji:'ü•ó',name:'Salade Avocat-Quinoa',desc:'Quinoa chaud + avocat + tomates cerises + concombre + vinaigrette citron-huile d\'olive. Riche en bons gras pour les hormones.',kcal:'380 kcal',temps:'15 min',ingredients:['Quinoa 80g','Avocat','Tomates cerises','Concombre','Citron','Huile d\'olive']}],
        collations:[{emoji:'üçå',title:'Banane + amandes',desc:'√ânergie rapide avant la s√©ance. Glucides + lipides pour tenir l\'effort.',kcal:'~220 kcal'},{emoji:'ü´ô',title:'Yaourt grec + miel + fruits rouges',desc:'Prot√©ines lentes et antioxydants. Parfait en collation post-entra√Ænement.',kcal:'~180 kcal'},{emoji:'ü•ú',title:'Beurre cacahu√®te + galette de riz',desc:'Sati√©t√© longue dur√©e. Prot√©ines et glucides complexes sans sucre ajout√©.',kcal:'~200 kcal'}]},
        2:{name:'MARDI',focus:'VENTRE PLAT & CARDIO',emoji:'üî•',exercises:[{name:'Crunchs Bicycle',sets:'4x30 reps',focus:'Obliques et abdominaux droits. Le meilleur exercice pour affiner la taille.'},{name:'Gainage',sets:'4x45 sec',focus:'Transverse abdominal. Rentre le ventre en profondeur, donne un ventre plat durable.'},{name:'Jumping Jacks',sets:'5x1 min',focus:'Cardio total body, br√ªle les graisses et am√©liore l\'endurance cardiovasculaire.'},{name:'Russian Twist',sets:'4x20 reps',focus:'Obliques : sculpte la taille et r√©duit les poign√©es d\'amour.'},{name:'Mountain Climbers',sets:'4x30 sec',focus:'Core et cardio intense. Br√ªle jusqu\'√† 10 calories par minute d\'effort.'},{name:'Relev√©s de Jambes',sets:'3x15 reps',focus:'Abdominaux bas et psoas. Raffermit le bas du ventre, zone difficile √† travailler.'}],
        recettes:[{emoji:'ü•í',name:'Wrap Detox Ventre Plat',desc:'Galette de bl√© complet + thon + concombre + menthe + yaourt 0%. L√©ger, digeste, anti-ballonnements.',kcal:'320 kcal',temps:'10 min',ingredients:['Galette bl√© complet','Thon 120g','Concombre','Menthe fra√Æche','Yaourt 0%','Citron']},{emoji:'üçµ',name:'Soupe Miso & L√©gumes',desc:'Bouillon miso + tofu soyeux + algues + champignons shiitak√©. Probiotiques naturels pour un ventre plat.',kcal:'180 kcal',temps:'20 min',ingredients:['P√¢te miso','Tofu soyeux','Algues wakam√©','Champignons','Ciboule']}],
        collations:[{emoji:'üçã',title:'Eau citronn√©e + concombre',desc:'√Ä jeun le matin. Booste le m√©tabolisme et r√©duit la r√©tention d\'eau.',kcal:'~5 kcal'},{emoji:'ü´ê',title:'Smoothie d√©tox vert',desc:'√âpinards + concombre + gingembre + citron + eau de coco. Anti-ballonnements puissant.',kcal:'~120 kcal'},{emoji:'ü•ù',title:'Kiwi + fromage blanc 0%',desc:'Enzymes digestives du kiwi + prot√©ines. Digestion optimale et ventre plat.',kcal:'~150 kcal'}]},
        3:{name:'MERCREDI',focus:'CARDIO BR√õLE-GRAISSE',emoji:'üèÉ',exercises:[{name:'HIIT 20/10',sets:'8 rounds',focus:'Cardio intensif par intervalles. Effet afterburn : continue de br√ªler apr√®s l\'effort.'},{name:'Corde √† Sauter',sets:'5x3 min',focus:'Mollets, cardio et coordination. Br√ªle 15 kcal/min, tr√®s efficace pour maigrir.'},{name:'Burpees',sets:'4x10 reps',focus:'Full body. Variante accessible qui sollicite tout le corps sans choc excessif.'},{name:'Step-Up',sets:'4x15/c√¥t√©',focus:'Fessiers et cuisses avec cardio. Excellent pour tonifier les jambes en br√ªlant des calories.'}],
        recettes:[{emoji:'üèÉ',name:'Riz Poulet Pr√©-Cardio',desc:'Riz blanc + blanc de poulet + l√©gumes vapeur + sauce soja l√©g√®re. Digeste, √©nergie durable pour le cardio.',kcal:'420 kcal',temps:'20 min',ingredients:['Blanc poulet 150g','Riz blanc','Brocoli','Haricots verts','Sauce soja','Gingembre']},{emoji:'ü•§',name:'Shake R√©cup√©ration Maison',desc:'Lait v√©g√©tal + whey l√©g√®re + banane + beurre cacahu√®te + gla√ßons. Dans les 30min apr√®s le cardio.',kcal:'340 kcal',temps:'5 min',ingredients:['Lait d\'amande','Whey vanille 25g','Banane','Beurre cacahu√®te 1 cs']}],
        collations:[{emoji:'üçå',title:'Banane + caf√© noir',desc:'30 min avant le cardio. √ânergie imm√©diate + thermogen√®se boost√©e par la caf√©ine.',kcal:'~110 kcal'},{emoji:'üßÉ',title:'Eau de coco + pinc√©e de sel',desc:'√âlectrolytes naturels pendant l\'effort. Hydratation optimale sans sucre raffin√©.',kcal:'~50 kcal'},{emoji:'üçä',title:'Orange + noix de cajou',desc:'Vitamine C + lipides sains. R√©cup√©ration rapide apr√®s le cardio intense.',kcal:'~200 kcal'}]},
        4:{name:'JEUDI',focus:'BRAS & D√âCOLLET√â',emoji:'üí™',exercises:[{name:'Pompes Genoux',sets:'4x15 reps',focus:'Pectoraux et triceps en douceur. Affermit le d√©collet√© et lutte contre la ptose mammaire.'},{name:'Curl L√©gers',sets:'4x15 reps',focus:'Biceps toniques sans volume. Dessine le bras sans gonfler les muscles.'},{name:'Extension Triceps',sets:'3x15 reps',focus:'Triceps : zone souvent l√¢che chez les femmes. Affermit l\'arri√®re du bras.'},{name:'Rowing Halt√®res',sets:'3x12 reps',focus:'Dos et √©paules. Am√©liore la posture et ouvre le d√©collet√© naturellement.'},{name:'√âcart√©s',sets:'3x15 reps',focus:'Pectoraux internes. Soutient et remonte la poitrine naturellement.'}],
        recettes:[{emoji:'üêü',name:'Saumon Citron & Quinoa',desc:'Pav√© de saumon au four + quinoa + √©pinards saut√©s ail + zeste citron. Collag√®ne et om√©ga-3 pour une peau ferme.',kcal:'460 kcal',temps:'25 min',ingredients:['Saumon 150g','Quinoa 70g','√âpinards','Ail','Citron','Huile olive']},{emoji:'ü•ö',name:'Omelette Prot√©in√©e Champignons',desc:'3 ≈ìufs entiers + champignons + √©pinards + herbes. Collag√®ne naturel pour tonifier bras et d√©collet√©.',kcal:'280 kcal',temps:'10 min',ingredients:['3 ≈ìufs','Champignons','√âpinards','Ciboulette','Sel poivre']}],
        collations:[{emoji:'üßÄ',title:'Fromage cottage + graines de lin',desc:'Prot√©ines + om√©ga-3. Tonifie la peau et les muscles des bras en profondeur.',kcal:'~160 kcal'},{emoji:'ü´ê',title:'Smoothie collag√®ne',desc:'Fruits rouges + jus d\'orange + poudre de collag√®ne marine. Fermet√© de la peau et du d√©collet√©.',kcal:'~140 kcal'},{emoji:'üçä',title:'Kiwi + amandes',desc:'Vitamine C (synth√®se collag√®ne) + vitamine E (antioxydant). Duo beaut√© parfait.',kcal:'~180 kcal'}]},
        5:{name:'VENDREDI',focus:'FULL BODY TONIQUE',emoji:'‚ú®',exercises:[{name:'Squat Saut√©',sets:'4x15 reps',focus:'Puissance explosive des jambes et fessiers. Br√ªle un maximum de graisses.'},{name:'Pompes Inclin√©es',sets:'4x12 reps',focus:'Partie haute des pectoraux et √©paules. Affine et tonifie le haut du corps.'},{name:'Fentes Saut√©es',sets:'3x10/c√¥t√©',focus:'Fessiers et cuisses en explosif. Cardio et gainage simultan√©s tr√®s efficaces.'},{name:'Gainage Lat√©ral',sets:'3x30sec/c√¥t√©',focus:'Obliques et hanches. Sculpte la taille et r√©duit les poign√©es d\'amour.'},{name:'Burpees',sets:'3x8 reps',focus:'Full body cardio. Combine force, explosivit√© et endurance en un seul mouvement.'}],
        recettes:[{emoji:'‚ö°',name:'Power Bowl Full Body',desc:'Patate douce r√¥tie + dinde hach√©e √©pic√©e + avocat + ≈ìuf poch√© + roquette. Repas complet haute performance.',kcal:'520 kcal',temps:'30 min',ingredients:['Patate douce','Dinde 150g','Avocat','≈íuf','Roquette','√âpices']},{emoji:'ü•§',name:'Shake Banane-Cacao R√©cup',desc:'Lait d\'avoine + banane congel√©e + cacao + proteines + beurre cacahu√®te. Recharge glycog√®ne et synth√®se prot√©ique.',kcal:'380 kcal',temps:'5 min',ingredients:['Lait d\'avoine 300ml','Banane','Cacao 15g','Whey 25g','Beurre cacahu√®te']}],
        collations:[{emoji:'‚òï',title:'Caf√© noir + chocolat noir 85%',desc:'Dopamine + antioxydants. √ânergie et concentration maximales avant la s√©ance intense.',kcal:'~80 kcal'},{emoji:'üçá',title:'Raisins + noix',desc:'Sucres naturels + lipides. √ânergie soutenue sans pic glyc√©mique pour tenir tout l\'entra√Ænement.',kcal:'~220 kcal'},{emoji:'üç´',title:'Energy ball maison',desc:'Dattes + avoine + cacao + noix de coco. Collation pr√©-workout naturelle et rassasiante.',kcal:'~180 kcal'}]},
        6:{name:'SAMEDI',focus:'YOGA & SOUPLESSE',emoji:'üßò',exercises:[{name:'Salutation Soleil',sets:'5 cycles',focus:'√âtire et renforce tout le corps. Active le m√©tabolisme en douceur le matin.'},{name:'Pigeon Yoga',sets:'3x1min/c√¥t√©',focus:'Ouverture des hanches et psoas. Lib√®re les tensions accumul√©es dans les fessiers.'},{name:'Chat-Vache',sets:'3x10 reps',focus:'Mobilise la colonne vert√©brale. Soulage les douleurs lombaires et am√©liore la posture.'},{name:'Chien T√™te en Bas',sets:'3x45 sec',focus:'√âtirement global, mollets, dos et √©paules. Favorise la circulation sanguine.'}],
        recettes:[{emoji:'üßò',name:'Buddha Bowl Detox',desc:'Riz noir + l√©gumes vapeur color√©s + edamame + sauce miso-gingembre. Anti-inflammatoire et r√©g√©n√©rateur.',kcal:'400 kcal',temps:'25 min',ingredients:['Riz noir 80g','Brocoli','Carottes','Edamame','Miso','Gingembre','S√©same']},{emoji:'ü´ô',name:'Overnight Oats R√©cup√©ration',desc:'Flocons d\'avoine + lait v√©g√©tal + chia + fruits frais + miel. Pr√©par√© la veille, parfait pour le lendemain.',kcal:'350 kcal',temps:'5 min + nuit',ingredients:['Flocons avoine 60g','Lait amande','Graines chia','Fruits rouges','Miel']}],
        collations:[{emoji:'ü´ñ',title:'Tisane ortie-pissenlit',desc:'Drainante et d√©toxifiante naturelle. √âlimine les toxines et r√©duit la r√©tention d\'eau.',kcal:'~0 kcal'},{emoji:'üçµ',title:'Latte matcha lait d\'avoine',desc:'Antioxydants + √©nergie douce. Boost m√©tabolique sans nervosit√© ni crash.',kcal:'~90 kcal'},{emoji:'üç´',title:'Chocolat noir 70% + noisettes',desc:'Magn√©sium naturel + bons gras. Contre les crampes et favorise la r√©cup√©ration musculaire.',kcal:'~200 kcal'}]},
        0:{name:'DIMANCHE',focus:'R√âCUP√âRATION & BIEN-√äTRE',emoji:'üíÜ',exercises:[{name:'Marche Active',sets:'30-45 min',focus:'Cardio l√©ger : maintient l\'activation musculaire. Br√ªle les graisses en douceur.'},{name:'Stretching Global',sets:'20 min',focus:'Rel√¢chement musculaire complet. Pr√©vention des blessures et am√©lioration de la souplesse.'},{name:'Respiration',sets:'10 min',focus:'Coh√©rence cardiaque : r√©duit le cortisol et favorise la r√©cup√©ration musculaire.'},{name:'Auto-massage',sets:'15 min',focus:'Foam roller : d√©noue les tensions, am√©liore la circulation et r√©duit la cellulite.'}],
        recettes:[{emoji:'üíÜ',name:'Porridge R√©cup√©ration Ultime',desc:'Flocons d\'avoine + banane + myrtilles + miel + graines de lin. Anti-inflammatoire, doux pour la digestion.',kcal:'350 kcal',temps:'10 min',ingredients:['Flocons avoine 70g','Banane','Myrtilles','Miel','Graines de lin','Lait v√©g√©tal']},{emoji:'ü•ó',name:'Salade Arc-en-Ciel',desc:'√âpinards + betterave + carottes + grenade + noix + f√©ta + vinaigrette miel-citron. Maximum de vitamines.',kcal:'320 kcal',temps:'15 min',ingredients:['√âpinards','Betterave','Carottes','Grenade','Noix','F√©ta','Miel','Citron']}],
        collations:[{emoji:'üçØ',title:'Lait chaud + miel + cannelle',desc:'Anti-inflammatoire et relaxant. Id√©al le soir pour un sommeil r√©parateur et une r√©cup√©ration optimale.',kcal:'~120 kcal'},{emoji:'ü´ê',title:'Smoothie bowl r√©cup',desc:'A√ßa√Ø + fruits rouges + banane + graines de chia. Antioxydants maximaux pour la r√©paration cellulaire.',kcal:'~280 kcal'},{emoji:'ü•ë',title:'Tartine avocat + ≈ìuf',desc:'Bons gras + prot√©ines. Sati√©t√© durable et nutriments essentiels pour r√©cup√©rer sans se priver.',kcal:'~300 kcal'}]}
    },
    homme: {
        1:{name:'LUNDI',focus:'JAMBES & FORCE',emoji:'ü¶µ',exercises:[{name:'Squat Barre',sets:'5x5 reps',focus:'Quadriceps, ischio-jambiers, fessiers. Le roi des exercices de force et de masse musculaire.'},{name:'Presse √† Cuisses',sets:'4x10 reps',focus:'Quadriceps en surcharge progressive. Id√©al pour prendre du volume sur les jambes.'},{name:'Soulev√© de Terre',sets:'4x5 reps',focus:'Cha√Æne post√©rieure compl√®te. L\'exercice de force le plus complet qui soit.'},{name:'Fentes March√©es',sets:'3x12/jambe',focus:'Quadriceps et fessiers en unilat√©ral. Corrige les d√©s√©quilibres musculaires.'},{name:'Leg Extension',sets:'3x15 reps',focus:'Isolation des quadriceps. Finition pour le volume et la d√©finition des cuisses.'},{name:'Mollets Debout',sets:'5x20 reps',focus:'Gastrocn√©miens en force. Les mollets n√©cessitent beaucoup de r√©p√©titions pour progresser.'}],
        recettes:[{emoji:'ü•©',name:'Riz B≈ìuf L√©gumes Masse',desc:'Riz blanc 150g + steak hach√© 200g + brocoli + carottes + sauce soja. Repas de prise de masse classique et efficace.',kcal:'680 kcal',temps:'25 min',ingredients:['Steak hach√© 200g','Riz blanc 150g','Brocoli','Carottes','Sauce soja','Ail']},{emoji:'üç≥',name:'Omelette G√©ante R√©cup Jambes',desc:'5 ≈ìufs entiers + patate douce + √©pinards + fromage. Prot√©ines + glucides pour la reconstruction des fibres musculaires.',kcal:'560 kcal',temps:'15 min',ingredients:['5 ≈ìufs','Patate douce','√âpinards','Fromage r√¢p√©','Herbes']}],
        collations:[{emoji:'ü•õ',title:'Lait entier + banane + cr√©atine',desc:'Prise de masse optimale. Cr√©atine + glucides rapides + prot√©ines apr√®s la s√©ance jambes.',kcal:'~320 kcal'},{emoji:'ü•ú',title:'Beurre cacahu√®te + pain complet',desc:'Calorie-dense et rassasiant. Parfait pour les hardgainers qui peinent √† prendre du poids.',kcal:'~350 kcal'},{emoji:'üç´',title:'Fromage blanc + myrtilles + granola',desc:'Cas√©ine nocturne + antioxydants. Synth√®se prot√©ique toute la nuit apr√®s la grosse s√©ance.',kcal:'~280 kcal'}]},
        2:{name:'MARDI',focus:'PECTORAUX & TRICEPS',emoji:'üí™',exercises:[{name:'D√©velopp√© Couch√©',sets:'5x5 reps',focus:'Pectoraux majeurs, delto√Ødes ant√©rieurs et triceps. L\'exercice de r√©f√©rence du haut du corps.'},{name:'D√©velopp√© Inclin√©',sets:'4x8 reps',focus:'Pectoraux sup√©rieurs et claviculaires. Donne du volume et de la rondeur √† la poitrine.'},{name:'Dips Lest√©s',sets:'4x10 reps',focus:'Pectoraux inf√©rieurs et triceps. Excellent pour la profondeur et la d√©finition pectorale.'},{name:'√âcart√© Halt√®res',sets:'3x12 reps',focus:'√âtirement et contraction pectorale maximale. Am√©liore la s√©paration et le galbe.'},{name:'Triceps Barre',sets:'4x10 reps',focus:'Les 3 chefs du triceps. Le triceps repr√©sente 2/3 du bras, priorit√© pour le volume.'},{name:'Pompes Diamant',sets:'3xMax',focus:'Isolation maximale des triceps en bodyweight. Finition parfaite en fin de s√©ance.'}],
        recettes:[{emoji:'üçó',name:'Poulet Riz Prise de Masse',desc:'Blanc poulet 250g + riz complet + huile olive + ail + herbes. Le classique bodybuilding, simple et ultra efficace.',kcal:'620 kcal',temps:'20 min',ingredients:['Blanc poulet 250g','Riz complet 150g','Huile olive','Ail','Herbes provence']},{emoji:'ü•ö',name:'Pancakes Prot√©in√©s',desc:'4 ≈ìufs + flocons avoine + banane + whey. Repas pr√© ou post entra√Ænement gourmand et anabolisant.',kcal:'480 kcal',temps:'15 min',ingredients:['4 ≈ìufs','Flocons avoine 80g','Banane','Whey vanille 25g','Cannelle']}],
        collations:[{emoji:'‚òï',title:'Caf√© noir + 2 ≈ìufs durs',desc:'Caf√©ine pour la force + prot√©ines compl√®tes. Pr√©-workout naturel 30min avant la s√©ance.',kcal:'~160 kcal'},{emoji:'üç´',title:'Pain blanc + confiture + fromage blanc',desc:'Spike insulinique post-s√©ance. Recharge rapide du glycog√®ne + prot√©ines pour l\'anabolisme.',kcal:'~300 kcal'},{emoji:'ü•õ',title:'Shaker cas√©ine nuit',desc:'Prot√©ines lentes avant le coucher. Synth√®se prot√©ique nocturne pendant 8h de sommeil.',kcal:'~200 kcal'}]},
        3:{name:'MERCREDI',focus:'DOS & BICEPS',emoji:'üèãÔ∏è',exercises:[{name:'Tractions Lest√©es',sets:'5x5 reps',focus:'Grand dorsal et biceps en force. L\'exercice le plus efficace pour √©largir le dos.'},{name:'Rowing Barre',sets:'5x5 reps',focus:'√âpaisseur du dos : rhombo√Ødes, trap√®zes et grand dorsal. Donne une musculature dense.'},{name:'Tirage Horizontal',sets:'4x10 reps',focus:'Milieu du dos et biceps. Am√©liore la r√©traction des omoplates et la posture.'},{name:'Curl Halt√®res',sets:'4x10 reps',focus:'Biceps brachial et brachioradial. D√©veloppe le pic et le volume du biceps.'},{name:'Curl Marteau',sets:'3x12 reps',focus:'Brachioradial et long supinateur. √âpaissit l\'avant-bras et donne de la force de pr√©hension.'},{name:'Hyperextensions',sets:'3x15 reps',focus:'√ârecteurs du rachis et ischios. Prot√®ge le bas du dos et √©quilibre la musculature.'}],
        recettes:[{emoji:'üêü',name:'Saumon Riz Asiatique',desc:'Pav√© saumon 200g + riz basmati + edamame + sauce miso-gingembre + s√©same. Om√©ga-3 pour la r√©cup√©ration du dos.',kcal:'580 kcal',temps:'25 min',ingredients:['Saumon 200g','Riz basmati 130g','Edamame','Miso','Gingembre','S√©same']},{emoji:'ü•´',name:'Pasta Thon Haute Prot√©ine',desc:'P√¢tes compl√®tes + thon en conserve + tomates cerises + c√¢pres + huile olive. Rapide et hyperprot√©in√©.',kcal:'540 kcal',temps:'15 min',ingredients:['P√¢tes compl√®tes 150g','Thon 200g','Tomates cerises','C√¢pres','Huile olive']}],
        collations:[{emoji:'ü•ú',title:'Beurre cacahu√®te + c√©leri',desc:'Prot√©ines v√©g√©tales + fibres. Sati√©t√© garantie sans pic de glyc√©mie entre les repas.',kcal:'~200 kcal'},{emoji:'üßÉ',title:'Jus de betterave + pomme',desc:'Nitrates naturels + vitamines. Am√©liore la vascularisation et la pompe musculaire.',kcal:'~130 kcal'},{emoji:'üçå',title:'Banane + amandes + prot√©ine shake',desc:'Le trio gagnant post-training. Glucides rapides + lipides + prot√©ines pour l\'anabolisme.',kcal:'~350 kcal'}]},
        4:{name:'JEUDI',focus:'√âPAULES & TRAP√àZES',emoji:'üî±',exercises:[{name:'D√©velopp√© Militaire',sets:'5x5 reps',focus:'Delto√Ødes en force. Des √©paules larges cr√©ent le V-shape et une silhouette imposante.'},{name:'√âl√©vations Lat√©rales',sets:'4x15 reps',focus:'Delto√Ødes moyens. Donne la largeur d\'√©paule caract√©ristique des athl√®tes.'},{name:'√âl√©vations Frontales',sets:'3x12 reps',focus:'Delto√Ødes ant√©rieurs. Compl√®te le d√©veloppement de l\'√©paule pour un aspect 3D.'},{name:'Face Pull',sets:'4x15 reps',focus:'Delto√Ødes post√©rieurs et rotateurs. Pr√©vient les blessures et am√©liore la posture.'},{name:'Shrugs Barre',sets:'5x10 reps',focus:'Trap√®zes sup√©rieurs. Des trap√®zes d√©velopp√©s donnent une pr√©sence et une force per√ßue.'},{name:'Arnold Press',sets:'3x10 reps',focus:'Les 3 faisceaux des delto√Ødes en un seul mouvement. Maximum d\'efficacit√©.'}],
        recettes:[{emoji:'ü•©',name:'Steak Patate Douce √âpaules',desc:'Rumsteck 200g + patate douce r√¥tie + haricots verts + beurre d\'herbes. Zinc + cr√©atine naturelle pour la force.',kcal:'650 kcal',temps:'30 min',ingredients:['Rumsteck 200g','Patate douce 200g','Haricots verts','Beurre','Herbes','Ail']},{emoji:'ü´ò',name:'Chili de Lentilles Prot√©in√©',desc:'Lentilles corail + b≈ìuf hach√© + tomates + √©pices + riz. Recette √©conomique, hyperprot√©in√©e et anti-inflammatoire.',kcal:'580 kcal',temps:'35 min',ingredients:['Lentilles corail 150g','B≈ìuf hach√© 150g','Tomates concass√©es','Cumin','Paprika','Riz']}],
        collations:[{emoji:'üßÄ',title:'Fromage blanc + noix + miel',desc:'Zinc (fromage) + om√©ga-3 (noix) + glucides (miel). Trio parfait pour la testost√©rone et la r√©cup√©ration.',kcal:'~250 kcal'},{emoji:'üçä',title:'Orange + pistaches',desc:'Vitamine C pour les tendons des √©paules + prot√©ines v√©g√©tales. Sant√© articulaire optimis√©e.',kcal:'~220 kcal'},{emoji:'ü•õ',title:'Lait chocolat√© maison',desc:'Lait entier + cacao + miel + cannelle. R√©cup√©ration rapide et savoureuse apr√®s la s√©ance √©paules.',kcal:'~280 kcal'}]},
        5:{name:'VENDREDI',focus:'FULL BODY PUISSANCE',emoji:'üî•',exercises:[{name:'Clean & Jerk',sets:'5x3 reps',focus:'Explosivit√© totale du corps. L\'exercice olympique le plus complet pour la puissance athl√©tique.'},{name:'Squat Saut√© Lest√©',sets:'4x5 reps',focus:'Puissance explosive des jambes. D√©veloppe la vitesse et la force simultan√©ment.'},{name:'Med Ball Slam',sets:'4x10 reps',focus:'Full body explosif. Lib√®re l\'agressivit√© et d√©veloppe la puissance du core.'},{name:'Sprint 100m',sets:'6x100m',focus:'Vitesse maximale et puissance des jambes. Active le syst√®me nerveux central au maximum.'},{name:'Battle Rope',sets:'4x30 sec',focus:'Cardio intense et muscles des √©paules, dos et core. R√©sistance cardiovasculaire extr√™me.'}],
        recettes:[{emoji:'üî•',name:'Burger Maison Haute Perf',desc:'Pain complet + steak hach√© 200g + avocat + ≈ìuf + fromage + salade. Repas post-puissance ultra satisfaisant.',kcal:'720 kcal',temps:'20 min',ingredients:['Pain complet','Steak hach√© 200g','Avocat','≈íuf','Fromage','Salade']},{emoji:'‚ö°',name:'Power Shake R√©cup√©ration',desc:'Lait entier + banane + whey chocolat + flocons avoine + beurre cacahu√®te. Anabolisme maximal en 5 minutes.',kcal:'580 kcal',temps:'5 min',ingredients:['Lait entier 400ml','Banane','Whey chocolat 30g','Flocons avoine 50g','Beurre cacahu√®te']}],
        collations:[{emoji:'‚òï',title:'Caf√© + cr√©atine + jus de raisin',desc:'Le pre-workout naturel scientifiquement valid√©. Force +12%, endurance +18% en s√©ance.',kcal:'~120 kcal'},{emoji:'üçá',title:'Raisins secs + amandes',desc:'Glucides rapides + lipides. √ânergie explosive pour les sprints et mouvements olympiques.',kcal:'~250 kcal'},{emoji:'üçñ',title:'Poulet froid + pain complet',desc:'Snack post-s√©ance rapide. Prot√©ines + glucides pour stopper le catabolisme imm√©diatement.',kcal:'~320 kcal'}]},
        6:{name:'SAMEDI',focus:'MOBILIT√â & R√âCUP√âRATION',emoji:'ü§∏',exercises:[{name:'Foam Rolling',sets:'15 min',focus:'Lib√®re les adh√©rences des fascias. R√©cup√©ration acc√©l√©r√©e et mobilit√© am√©lior√©e.'},{name:'Mobilit√© Hanches',sets:'3x10/c√¥t√©',focus:'Ouverture des hanches pour des squats plus profonds et une meilleure posture.'},{name:'Mobilit√© √âpaules',sets:'3x15 reps',focus:'Pr√©vention des blessures √† l\'√©paule, la zone la plus vuln√©rable en musculation.'},{name:'Natation',sets:'30 min',focus:'R√©cup√©ration active, travaille tous les muscles sans impact articulaire.'}],
        recettes:[{emoji:'ü§∏',name:'Repas R√©cup Anti-Douleurs',desc:'Saumon + patate douce + √©pinards + curcuma + poivre noir. Om√©ga-3 + curcumine = anti-inflammatoire puissant.',kcal:'520 kcal',temps:'25 min',ingredients:['Saumon 180g','Patate douce','√âpinards','Curcuma','Poivre noir','Huile olive']},{emoji:'ü´ô',name:'Overnight Oats Prot√©in√©',desc:'Flocons avoine + cas√©ine + myrtilles + graines de chia. Pr√©par√© la veille, prot√©ines lentes toute la nuit.',kcal:'420 kcal',temps:'5 min + nuit',ingredients:['Flocons avoine 80g','Cas√©ine vanille 25g','Myrtilles','Graines chia','Lait']}],
        collations:[{emoji:'üíß',title:'Eau + BCAA + √©lectrolytes',desc:'R√©cup√©ration musculaire optimale. Les BCAA r√©duisent les courbatures de 30% selon les √©tudes.',kcal:'~30 kcal'},{emoji:'üçå',title:'Banane + fromage blanc + miel',desc:'Potassium + cas√©ine + glucides simples. Pr√©vention des crampes nocturnes garantie.',kcal:'~260 kcal'},{emoji:'üßÑ',title:'Bouillon de poule maison',desc:'Collag√®ne naturel + min√©raux + glutamine. R√©pare les tendons et l\'intestin apr√®s l\'effort intense.',kcal:'~50 kcal'}]},
        0:{name:'DIMANCHE',focus:'R√âCUP√âRATION TOTALE',emoji:'üßò',exercises:[{name:'Marche',sets:'45-60 min',focus:'Cardio l√©ger : maintient l\'activation musculaire sans surcharger le syst√®me nerveux.'},{name:'Yoga Homme',sets:'30 min',focus:'Flexibilit√© et mobilit√© : souvent n√©glig√©es par les hommes, pourtant essentielles √† la performance.'},{name:'M√©ditation',sets:'15 min',focus:'R√©cup√©ration mentale : r√©duit le cortisol et am√©liore la qualit√© du sommeil r√©parateur.'},{name:'√âtirements PNF',sets:'20 min',focus:'Technique avanc√©e : augmente l\'amplitude articulaire de 10-20% en quelques semaines.'}],
        recettes:[{emoji:'üßò',name:'Bol R√©cup√©ration Totale',desc:'Riz complet + saumon fum√© + avocat + edamame + algues + sauce miso. Maximum d\'om√©ga-3 et min√©raux pour r√©cup√©rer.',kcal:'550 kcal',temps:'15 min',ingredients:['Riz complet 120g','Saumon fum√© 100g','Avocat','Edamame','Algues','Miso']},{emoji:'ü•£',name:'Porridge Prot√©in√© Gourmand',desc:'Flocons avoine + lait entier + whey + fruits secs + miel + cannelle. Confort et performance r√©unis.',kcal:'480 kcal',temps:'10 min',ingredients:['Flocons avoine 90g','Lait entier','Whey 25g','Fruits secs','Miel','Cannelle']}],
        collations:[{emoji:'üçµ',title:'Tisane camomille + miel',desc:'Adenosine + sucres naturels. Pr√©pare le syst√®me nerveux au sommeil r√©parateur de la semaine.',kcal:'~40 kcal'},{emoji:'üç´',title:'Chocolat noir 85% + noisettes',desc:'Magn√©sium + om√©ga-9 + polyph√©nols. Relaxation musculaire et r√©paration pendant le sommeil.',kcal:'~220 kcal'},{emoji:'ü•õ',title:'Cas√©ine + graines de courge',desc:'8h de synth√®se prot√©ique nocturne. Le meilleur investissement nutrition de la semaine.',kcal:'~230 kcal'}]}
    }
};

// Neutre = mix femme/homme
PROGRAMS.neutre = {};
[0,1,2,3,4,5,6].forEach(d => {
    const f = PROGRAMS.femme[d], m = PROGRAMS.homme[d];
    PROGRAMS.neutre[d] = { name:f.name, focus:'√âQUILIBR√â', emoji:f.emoji, exercises:[...f.exercises.slice(0,3),...m.exercises.slice(0,3)], recettes:[...f.recettes], collations:[...m.collations] };
});

const CHALLENGES = [
    {id:1,nom:'50 Pompes',description:'Faire 50 pompes cons√©cutives ou en plusieurs s√©ries.',categorie:'üí™ Force',difficulte:'moyen',points:50,focus:'Pectoraux majeurs, triceps et delto√Ødes. Renforce le core si gainage maintenu.'},
    {id:2,nom:'Courir 5km',description:'Parcourir 5 kilom√®tres √† ton rythme.',categorie:'üèÉ Cardio',difficulte:'difficile',points:100,focus:'Cardiovasculaire, quadriceps, ischio-jambiers et mollets. Environ 350-400 kcal br√ªl√©es.'},
    {id:3,nom:'Planche 2 minutes',description:'Tenir la position planche 2 minutes en continu.',categorie:'üí™ Force',difficulte:'difficile',points:80,focus:'Transverse, obliques, √©recteurs du rachis. La base d\'un core solide et stable.'},
    {id:4,nom:'100 Jumping Jacks',description:'Encha√Æner 100 jumping jacks sans pause.',categorie:'üèÉ Cardio',difficulte:'facile',points:30,focus:'Mollets, abducteurs et delto√Ødes. Excellent pour l\'√©chauffement et le cardio l√©ger.'},
    {id:5,nom:'M√©ditation 10 min',description:'M√©diter en pleine conscience 10 minutes.',categorie:'üßò Bien-√™tre',difficulte:'facile',points:40,focus:'R√©duit le cortisol, am√©liore la concentration et la r√©cup√©ration musculaire.'},
    {id:6,nom:'30 Squats',description:'30 squats avec technique parfaite.',categorie:'üí™ Force',difficulte:'facile',points:35,focus:'Quadriceps, fessiers, ischio-jambiers. L\'exercice fondamental du bas du corps.'},
    {id:7,nom:'√âtirements 15 min',description:'Session compl√®te d\'√©tirements du corps entier.',categorie:'ü§∏ Flexibilit√©',difficulte:'facile',points:25,focus:'Am√©liore la souplesse et pr√©vient les blessures. R√©duit les tensions musculaires.'},
    {id:8,nom:'20 Burpees',description:'20 burpees complets avec saut.',categorie:'üèÉ Cardio',difficulte:'moyen',points:60,focus:'Full body : pectoraux, triceps, jambes et cardio. Environ 15 calories par minute.'},
    {id:9,nom:'40 Fentes',description:'20 fentes avant par jambe, genou √† 90 degr√©s.',categorie:'üí™ Force',difficulte:'moyen',points:45,focus:'Quadriceps, fessiers et ischios en unilat√©ral. Am√©liore l\'√©quilibre et la sym√©trie.'},
    {id:10,nom:'Nage 500m',description:'Nager 500 m√®tres en piscine.',categorie:'üèä Cardio',difficulte:'difficile',points:90,focus:'Dos, √©paules, bras et cardio sans impact articulaire. R√©cup√©ration active parfaite.'}
];

const SALUTATIONS = {
    femme: [
        { word: 'Bonjour', suite: '! Pr√™te √† te d√©passer ?' },
        { word: 'Bienvenue', suite: '! Ta transformation commence ici.' },
        { word: 'Salut', suite: '! On commence ?' },
        { word: 'Coucou', suite: '! C\'est l\'heure de briller !' },
        { word: 'Bonsoir', suite: '! Pr√™te √† tout donner ?' },
        { word: 'Rebonjour', suite: '! Contente de te revoir !' },
    ],
    homme: [
        { word: 'Bonjour', suite: '! Pr√™t √† te d√©passer ?' },
        { word: 'Bienvenue', suite: '! Ta transformation commence ici.' },
        { word: 'Salut', suite: '! On commence ?' },
        { word: 'Hey', suite: '! C\'est l\'heure de tout donner !' },
        { word: 'Bonsoir', suite: '! Pr√™t √† tout donner ?' },
        { word: 'Rebonjour', suite: '! Content de te revoir !' },
    ],
    neutre: [
        { word: 'Bonjour', suite: '! Pr√™t(e) √† te d√©passer ?' },
        { word: 'Bienvenue', suite: '! Ta transformation commence ici.' },
        { word: 'Salut', suite: '! On commence ?' },
        { word: 'Bonsoir', suite: '! Pr√™t(e) √† tout donner ?' },
        { word: 'Rebonjour', suite: '! Content(e) de te revoir !' },
        { word: 'Hey', suite: '! C\'est l\'heure de briller !' },
    ]
};

function getGreeting(gender) {
    const list = SALUTATIONS[gender] || SALUTATIONS.neutre;
    return list[Math.floor(Math.random() * list.length)];
}

const DAY_NAMES_SHORT = ['DIM','LUN','MAR','MER','JEU','VEN','SAM'];
let profile = JSON.parse(localStorage.getItem('fit_profile') || 'null');
let selections = {gender:null,goal:null,level:null};
let selectedDiff = 'all';
let currentChallenge = null;
let completed = JSON.parse(localStorage.getItem('fit_completed') || '[]');
let PROGRAM;

// Onboarding
document.querySelectorAll('.option-btn').forEach(btn => {
    btn.addEventListener('click', () => {
        const group = btn.dataset.group;
        document.querySelectorAll(`[data-group="${group}"]`).forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
        selections[group] = btn.dataset.value;
        checkReady();
    });
});

function checkReady() {
    const prenom = document.getElementById('prenomInput').value.trim();
    const ready = selections.gender && selections.goal && selections.level && prenom.length >= 2;
    document.getElementById('launchBtn').classList.toggle('ready', !!ready);
}

function launchApp() {
    const prenom = document.getElementById('prenomInput').value.trim();
    if (!selections.gender || !selections.goal || !selections.level || !prenom) return;
    profile = {...selections, prenom};
    localStorage.setItem('fit_profile', JSON.stringify(profile));
    startApp();
}

function startApp() {
    PROGRAM = PROGRAMS[profile.gender] || PROGRAMS.neutre;
    document.getElementById('onboarding').classList.remove('active');
    document.getElementById('mainApp').classList.add('active');

    // Salutation accord√©e selon le genre
    const greeting = getGreeting(profile.gender);
    const prenom = profile.prenom ? profile.prenom.charAt(0).toUpperCase() + profile.prenom.slice(1) : '';
    document.getElementById('salutationText').textContent = greeting.word + ',';
    document.getElementById('userGreeting').innerHTML = `<span>${prenom}</span> ${greeting.suite}`;

    const genderEmoji = profile.gender === 'femme' ? 'üë©' : profile.gender === 'homme' ? 'üë®' : '‚ö°';
    document.getElementById('profileSummary').textContent = `${genderEmoji} ${prenom} ¬∑ ${profile.goal} ¬∑ ${profile.level}`;
    initApp();
}

function resetProfile() {
    if (confirm('Changer de profil ?')) {
        localStorage.removeItem('fit_profile');
        profile = null; selections = {gender:null,goal:null,level:null};
        document.getElementById('mainApp').classList.remove('active');
        document.getElementById('onboarding').classList.add('active');
        document.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
        document.getElementById('prenomInput').value = '';
        document.getElementById('launchBtn').classList.remove('ready');
    }
}

if (profile) startApp();

function initApp() {
    const today = new Date();
    const dayIndex = today.getDay();
    const p = PROGRAM[dayIndex];
    document.getElementById('dayName').textContent = p.name;
    document.getElementById('dayFocus').textContent = p.emoji + ' ' + p.focus;
    document.getElementById('dayDate').textContent = today.toLocaleDateString('fr-FR', {day:'numeric',month:'long',year:'numeric'});
    renderWeek(dayIndex);
    renderWorkout(p);
    renderFood(p);
    updateStats();
    renderHistory();
}

function renderWeek(todayIndex) {
    document.getElementById('weekRow').innerHTML = [1,2,3,4,5,6,0].map(i => {
        const p = PROGRAM[i];
        return `<div class="week-day ${i===todayIndex?'today':''}" onclick="switchDay(${i})">
            <div class="wd-day">${DAY_NAMES_SHORT[i]}</div>
            <div class="wd-focus">${p.emoji}</div>
            <div class="wd-focus" style="font-size:0.6rem;margin-top:3px">${p.focus.split(' ')[0]}</div>
        </div>`;
    }).join('');
}

function switchDay(dayIndex) {
    const p = PROGRAM[dayIndex];
    document.getElementById('dayName').textContent = p.name;
    document.getElementById('dayFocus').textContent = p.emoji + ' ' + p.focus;
    renderWorkout(p); renderFood(p);
    document.querySelectorAll('.week-day').forEach((el,i) => el.classList.toggle('today', [1,2,3,4,5,6,0][i]===dayIndex));
}

function renderWorkout(p) {
    document.getElementById('workoutLabel').textContent = `S√©ance ${p.name.toLowerCase()} ‚Äî ${p.focus}`;
    document.getElementById('workoutGrid').innerHTML = p.exercises.map((ex,i) => `
        <div class="exercise-card">
            <div class="ex-number">${String(i+1).padStart(2,'0')}</div>
            <div class="ex-name">${ex.name}</div>
            <div class="ex-sets">${ex.sets}</div>
            <div class="ex-focus">${ex.focus}</div>
        </div>`).join('');
}

function renderFood(p) {
    document.getElementById('foodLabel').textContent = `Recettes & Collations ‚Äî ${p.name.toLowerCase()} ${p.focus}`;

    // Recettes
    document.getElementById('recettesGrid').innerHTML = p.recettes.map(r => `
        <div class="recette-card">
            <div class="recette-header">
                <span class="recette-emoji">${r.emoji}</span>
                <div class="recette-info">
                    <div class="recette-name">${r.name}</div>
                    <div class="recette-meta">
                        <span class="recette-tag">‚è± ${r.temps}</span>
                        <span class="recette-tag">üî• ${r.kcal}</span>
                    </div>
                </div>
            </div>
            <div class="recette-desc">${r.desc}</div>
            <div class="recette-ingredients">
                ${r.ingredients.map(i => `<span class="ingredient-pill">${i}</span>`).join('')}
            </div>
        </div>`).join('');

    // Collations
    document.getElementById('collationsGrid').innerHTML = p.collations.map(c => `
        <div class="collation-item">
            <span class="collation-emoji">${c.emoji}</span>
            <div class="collation-text">
                <div class="collation-title">${c.title}</div>
                <div class="collation-desc">${c.desc}</div>
                <div class="collation-kcal">${c.kcal}</div>
            </div>
        </div>`).join('');
}

document.querySelectorAll('.diff-btn').forEach(btn => {
    btn.addEventListener('click', () => {
        document.querySelectorAll('.diff-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        selectedDiff = btn.dataset.diff;
    });
});

document.getElementById('generateBtn').addEventListener('click', () => {
    let pool = selectedDiff === 'all' ? CHALLENGES : CHALLENGES.filter(c => c.difficulte === selectedDiff);
    if (!pool.length) { showToast('Aucun d√©fi pour cette difficult√© !'); return; }
    currentChallenge = pool[Math.floor(Math.random()*pool.length)];
    document.getElementById('chName').textContent = currentChallenge.nom;
    document.getElementById('chDesc').textContent = currentChallenge.description;
    document.getElementById('chCat').textContent = currentChallenge.categorie;
    document.getElementById('chDiff').textContent = currentChallenge.difficulte;
    document.getElementById('chPts').textContent = currentChallenge.points + ' pts';
    document.getElementById('chFocus').textContent = currentChallenge.focus;
    document.getElementById('challengeResult').classList.add('visible');
});

document.getElementById('completeBtn').addEventListener('click', () => {
    if (!currentChallenge) return;
    const today = new Date().toISOString().split('T')[0];
    completed.push({challenge:currentChallenge, date:today, ts:new Date().toISOString()});
    localStorage.setItem('fit_completed', JSON.stringify(completed));
    updateStats(); renderHistory();
    showToast('üéâ Bravo ! D√©fi compl√©t√© ! +' + currentChallenge.points + ' points');
    document.getElementById('challengeResult').classList.remove('visible');
    currentChallenge = null;
});

function updateStats() {
    document.getElementById('statTotal').textContent = completed.length;
    document.getElementById('statStreak').textContent = calcStreak();
    document.getElementById('statBest').textContent = calcBestStreak();
}

function calcStreak() {
    if (!completed.length) return 0;
    const today = new Date().toISOString().split('T')[0];
    const dates = [...new Set(completed.map(c=>c.date))].sort().reverse();
    let streak = 0;
    for (let d of dates) { const diff = Math.floor((new Date(today)-new Date(d))/86400000); if (diff===streak) streak++; else break; }
    return streak;
}

function calcBestStreak() {
    if (!completed.length) return 0;
    const dates = [...new Set(completed.map(c=>c.date))].sort();
    let best=1, cur=1;
    for (let i=1; i<dates.length; i++) { const diff=Math.floor((new Date(dates[i])-new Date(dates[i-1]))/86400000); if (diff===1){cur++;best=Math.max(best,cur);}else cur=1; }
    return best;
}

function renderHistory() {
    const list = document.getElementById('historyList');
    if (!completed.length) { list.innerHTML='<div class="empty-msg">Aucun d√©fi compl√©t√© pour le moment. Lance-toi ! üí™</div>'; return; }
    list.innerHTML = [...completed].reverse().slice(0,8).map(item => `
        <div class="history-item">
            <div><div class="h-name">${item.challenge.nom}</div><div style="font-size:0.75rem;color:var(--grey);margin-top:2px">${item.challenge.categorie} ¬∑ ${item.challenge.points} pts</div></div>
            <div class="h-date">${new Date(item.date).toLocaleDateString('fr-FR')}</div>
        </div>`).join('');
}

function showToast(msg) {
    const t = document.getElementById('toast');
    t.textContent = msg; t.classList.add('show');
    setTimeout(() => t.classList.remove('show'), 3500);
}
</script>
</body>
</html>